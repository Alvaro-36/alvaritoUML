<!DOCTYPE html>
<html lang="en">
<head>
    <base href="/" />
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=1" />
    <meta name="color-scheme" content="light dark" />
    <link rel="icon" href="favicon.ico" type="image/x-icon"/>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
    
    <!-- Estilos -->
    <link rel="stylesheet" href="min/plantuml.min.css" />
    <link rel="stylesheet" href="components/preview/menu/menuStyle.css">
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v2.1.9/css/unicons.css">
    
    <!-- Scripts base - EN ORDEN -->
    <script src="js/app-init.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
    <script src="js/plantuml-base.js"></script>
    <script src="js/plantuml-encoder.js"></script>
    
    <!-- TODO: Aquí cargaríamos SOLO los archivos que quieres editar -->
    <!-- Por ahora usa el minificado que ya tiene todo -->
    <script src="min/plantuml.min.js"></script>
    <script src="min/plantuml-language.min.js"></script>
    
    <!-- Monaco Editor desde CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.36.1/min/vs/loader.js"></script>
    
    <title>PlantUML - AlvaritoUML (DEV MODE)</title>
</head>
<body>
  <div class="app flex-rows">
    <!-- Header -->
    <div class="header">
      <h1>PlantUML - AlvaritoUML <span style="color: #ff6b6b;">(DEV MODE)</span></h1>
      <div>
        <img
          style="display: inline; position: absolute; top: 0; right: 0; border: 0; max-width: 25%;"
          class="no-filter"
          src="assets/github-fork-me.svg"
          alt="Fork me on GitHub"
          usemap="#github-banner"
        />
        <map id="github-banner" name="github-banner" style="cursor: pointer;">
          <area
            shape="poly"
            coords="10,0 50,0 149,100 149,140"
            href="https://github.com/plantuml/plantuml-server"
            alt="Fork me on GitHub"
          />
        </map>
      </div>
      <p>Create your <a href="https://plantuml.com">PlantUML</a> diagrams directly in your browser!</p>
    </div>

    <!-- Main content: Editor + Preview -->
    <div class="main flex-main flex-columns">
      
      <!-- Editor -->
      <div id="editor-main-container" class="editor flex-main flex-rows">
        <!-- URL Input Bar -->
        <div>
          <div class="btn-input">
            <input id="url" type="text" name="url" value="https://www.plantuml.com/plantuml/png/SyfFKj2rKt3CoKnELR1Io4ZDoSa70000" />
            <input id="url-copy-btn" type="image" alt="copy" src="assets/actions/copy.svg" tabindex="-1" />
          </div>
        </div>
        
        <!-- Monaco Editor -->
        <div class="flex-main monaco-editor-container">
          <textarea id="initCode" name="initCode" style="display: none;">@startuml&#10;Bob -&gt; Alice : hello&#10;@enduml</textarea>
          <div id="monaco-editor"></div>
          
          <!-- Editor Menu -->
          <div class="editor-menu" tabindex="-1">
            <div class="menu-kebab">
              <div class="kebab-circle"></div>
              <div class="kebab-circle"></div>
              <div class="kebab-circle"></div>
              <div class="kebab-circle"></div>
              <div class="kebab-circle"></div>
            </div>
            <div class="menu-items">
              <input id="menu-item-editor-code-copy" class="menu-item" type="image" alt="copy" title="Copy code" src="assets/actions/copy.svg" />
              <input class="menu-item" type="image" alt="import" title="Import diagram" src="assets/actions/upload.svg" onclick="openModal('diagram-import')" />
              <input class="menu-item" type="image" alt="export" title="Export diagram" src="assets/actions/download.svg" onclick="openModal('diagram-export')" />
            </div>
          </div>
        </div>
      </div>
      
      <!-- Preview -->
      <div id="previewer-main-container" class="previewer flex-main">
        <div class="previewer-container flex-rows">
          
          <!-- Preview Menu -->
          <div class="preview-menu">
            <div class="diagram-links flex-columns">
              <span>View as:</span>
              <a class="diagram-link" data-img-type="png" href="https://www.plantuml.com/plantuml/png/SyfFKj2rKt3CoKnELR1Io4ZDoSa70000" title="View diagram as PNG">
                <img src="assets/file-types/png.svg" alt="PNG" />
              </a>
              <a class="diagram-link" data-img-type="svg" href="https://www.plantuml.com/plantuml/svg/SyfFKj2rKt3CoKnELR1Io4ZDoSa70000" title="View diagram as SVG">
                <img src="assets/file-types/svg.svg" alt="SVG" />
              </a>
              <a class="diagram-link" data-img-type="txt" href="https://www.plantuml.com/plantuml/txt/SyfFKj2rKt3CoKnELR1Io4ZDoSa70000" title="View diagram as ASCII Art">
                <img src="assets/file-types/ascii.svg" alt="ASCII Art" />
              </a>
              <a class="diagram-link" data-img-type="pdf" href="https://www.plantuml.com/plantuml/pdf/SyfFKj2rKt3CoKnELR1Io4ZDoSa70000" title="View diagram as PDF">
                <img src="assets/file-types/pdf.svg" alt="PDF" />
              </a>
              
              <!-- Botón de Google Drive -->
              <div>
                <button class="gsi-material-button" id="google-auth-button" onclick="handleGoogleAuthClick()">
                  <div class="gsi-material-button-state"></div>
                  <div class="gsi-material-button-content-wrapper">
                    <div class="gsi-material-button-icon">
                      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" xmlns:xlink="http://www.w3.org/1999/xlink" style="display: block;">
                        <path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"></path>
                        <path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"></path>
                        <path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"></path>
                        <path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"></path>
                        <path fill="none" d="M0 0h48v48H0z"></path>
                      </svg>
                    </div>
                    <span class="gsi-material-button-contents">Sign in with Google</span>
                    <span style="display: none;">Sign in with Google</span>
                  </div>
                </button>
                
                <!-- Dropdown de archivos -->
                <div class="sec-center" id="files-dropdown" style="display: none; margin-top: 10px;">
                  <input class="dropdown" type="checkbox" id="dropdown" name="dropdown"/>
                  <label class="for-dropdown" for="dropdown">
                    <span id="dropdown-title">Seleccionar proyecto</span> 
                    <i class="uil uil-arrow-down"></i>
                  </label>
                  <div class="section-dropdown" id="section-dropdown">
                    <!-- Los archivos se cargarán dinámicamente aquí -->
                  </div>
                </div>
              </div>
              
              <a id="map-diagram-link" class="diagram-link" data-img-type="map" href="https://www.plantuml.com/plantuml/map/SyfFKj2rKt3CoKnELR1Io4ZDoSa70000" title="View diagram as Map Data" style="display: none;">
                <img src="assets/file-types/map.svg" alt="MAP" />
              </a>
              
              <div class="flex-main menu-r">
                <div class="btn-float-r">
                  <input id="btn-settings" class="btn-settings" type="image" src="assets/actions/settings.svg" alt="settings" onclick="openModal('settings')" />
                  <input id="btn-undock" class="btn-dock" type="image" src="assets/actions/undock.svg" alt="undock" />
                  <input id="btn-dock" class="btn-dock" type="image" src="assets/actions/dock.svg" alt="dock" onclick="window.close();" style="display: none;" />
                </div>
              </div>
            </div>
          </div>
          
          <div class="hr"></div>
          
          <!-- Paginator -->
          <div id="paginator" data-number-of-diagram-pages="1" style="display: none;"></div>
          
          <!-- Diagram Display -->
          <div class="previewer-main flex-main">
            <div id="diagram" class="diagram">
              <div>
                <img id="diagram-png" src="https://www.plantuml.com/plantuml/png/SyfFKj2rKt3CoKnELR1Io4ZDoSa70000" alt="PlantUML diagram" usemap="#plantuml_map" />
                <map id="plantuml_map" name="plantuml_map"></map>
                <svg id="diagram-svg" style="display: none;"></svg>
                <pre id="diagram-txt" style="display: none;"></pre>
                <object id="diagram-pdf" data="" type="application/pdf" width="100%" height="100%" style="display: none;">
                  <p>Unable to display PDF file.</p>
                </object>
              </div>
            </div>
          </div>
          
          <!-- Settings Modal -->
          <div id="settings" class="modal" style="display: none;" tabindex="-1">
            <div class="modal-content flex-rows">
              <div class="modal-header">
                <h2>Settings</h2>
                <div class="hr"></div>
              </div>
              <div class="modal-main flex-main">
                <div class="label-input-pair flex-columns">
                  <label for="theme">Theme:</label>
                  <select class="flex-main" id="theme" name="theme">
                    <option value="light">Light</option>
                    <option value="dark">Dark</option>
                  </select>
                </div>
                <div class="label-input-pair flex-columns">
                  <label for="diagramPreviewType">Diagram Preview Type:</label>
                  <select class="flex-main" id="diagramPreviewType" name="diagramPreviewType">
                    <option value="png">PNG</option>
                    <option value="svg">SVG</option>
                    <option value="txt">ASCII Art</option>
                    <option value="pdf">PDF</option>
                  </select>
                </div>
                <div class="label-input-pair flex-columns">
                  <label for="editorWatcherTimeout">Editor Watcher Timeout:</label>
                  <input class="flex-main" id="editorWatcherTimeout" type="number" pattern="[1-9]+[0-9]*" value="" />
                </div>
                <div class="label-input-pair flex-main">
                  <label for="editorCreateOptions">Monaco Editor Create Options:</label>
                  <br />
                  <div id="settings-monaco-editor"></div>
                </div>
              </div>
              <div class="modal-footer">
                <input id="settings-ok-btn" class="ok" type="button" value="Save" />
                <input class="cancel" type="button" value="Cancel" onclick="closeModal('settings');" />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Footer -->
    <div class="footer">
      <p>PlantUML - AlvaritoUML | Powered by <a href="https://www.plantuml.com/plantuml">PlantUML Official Server</a></p>
    </div>
    
    <!-- Import Modal -->
    <div id="diagram-import" class="modal" style="display: none;" tabindex="-1">
      <div class="modal-content flex-rows">
        <div class="modal-header">
          <h2>Import Diagram</h2>
          <div class="hr"></div>
        </div>
        <div class="modal-main flex-main">
          <input id="diagram-import-input" type="file" name="diagram" />
          <p id="diagram-import-error-message" class="error-message"></p>
        </div>
        <div class="modal-footer">
          <input id="diagram-import-ok-btn" class="ok" type="button" value="Import" disabled />
          <input id="diagram-import-cancel-btn" class="cancel" type="button" value="Cancel" onclick="closeModal('diagram-import');" />
        </div>
      </div>
    </div>
    
    <!-- Export Modal -->
    <div id="diagram-export" class="modal" style="display: none;" tabindex="-1">
      <div class="modal-content flex-rows">
        <div class="modal-header">
          <h2>Export Diagram</h2>
          <div class="hr"></div>
        </div>
        <div class="modal-main flex-main">
          <div class="label-input-pair flex-columns">
            <label for="download-name">Diagram name:</label>
            <input class="flex-main" id="download-name" value="diagram.puml" />
          </div>
          <div class="label-input-pair flex-columns">
            <label for="download-type">Diagram type:</label>
            <select class="flex-main" id="download-type" name="download-type">
              <option value="txt">ASCII Art</option>
              <option value="base64">Base64</option>
              <option value="eps">EPS</option>
              <option value="epstext">EPS Text</option>
              <option value="map">MAP</option>
              <option value="pdf">PDF</option>
              <option value="code" selected>PlantUML source code</option>
              <option value="png">PNG</option>
              <option value="svg">SVG</option>
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <input id="diagram-export-ok-btn" class="ok" type="button" value="Export" />
          <input class="cancel" type="button" value="Cancel" onclick="closeModal('diagram-export')" />
        </div>
      </div>
    </div>
  </div>
  
  <!-- Google Drive Integration -->
  <script src="components/preview/menu/google-drive-config.js"></script>
  <script src="components/preview/menu/google-drive-integration.js"></script>
  
  <!-- Cargar Google APIs después de nuestra configuración -->
  <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
  <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
</body>
</html>
